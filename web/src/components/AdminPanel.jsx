import React,{useEffect,useState} from 'react'
import {api} from '../utils/api'
export default function AdminPanel(){const[key,setKey]=useState(localStorage.getItem('admin_key')||'');const[suppliers,setSuppliers]=useState([]);const[categories,setCategories]=useState([]);const[newSupplier,setNewSupplier]=useState('');const[newCategory,setNewCategory]=useState('');const load=async()=>{const[s,c]=await Promise.all([api('/api/suppliers'),api('/api/categories')]);setSuppliers(s.map(x=>x.name));setCategories(c.map(x=>x.name))};useEffect(()=>{load()},[]);const saveKey=()=>{localStorage.setItem('admin_key',key);alert('Passcode saved for edits')};const addSupplier=async()=>{await api('/api/suppliers',{method:'POST',body:JSON.stringify({name:newSupplier}),headers:{'x-key':key}});setNewSupplier('');load()};const addCategory=async()=>{await api('/api/categories',{method:'POST',body:JSON.stringify({name:newCategory}),headers:{'x-key':key}});setNewCategory('');load()};return(<div className='bg-white p-4 rounded-2xl shadow grid gap-4'><h2 className='text-xl font-semibold'>Admin</h2><div className='grid gap-2'><label className='text-sm font-medium'>Passcode (ADMIN_KEY)</label><input className='border rounded p-2' value={key} onChange={e=>setKey(e.target.value)} placeholder='Enter the secret set on server'/><div><button className='px-4 py-2 rounded-xl border' onClick={saveKey}>Save Passcode</button></div></div><div className='grid md:grid-cols-2 gap-4'><div><h3 className='font-medium mb-2'>Suppliers</h3><ul className='text-sm mb-2'>{suppliers.map(s=><li key={s}>{s}</li>)}</ul><div className='flex gap-2'><input className='border rounded p-2 flex-1' value={newSupplier} onChange={e=>setNewSupplier(e.target.value)} placeholder='Add supplier'/><button className='px-3 py-2 rounded-xl border' onClick={addSupplier}>Add</button></div></div><div><h3 className='font-medium mb-2'>Categories</h3><ul className='text-sm mb-2'>{categories.map(c=><li key={c}>{c}</li>)}</ul><div className='flex gap-2'><input className='border rounded p-2 flex-1' value={newCategory} onChange={e=>setNewCategory(e.target.value)} placeholder='Add category'/><button className='px-3 py-2 rounded-xl border' onClick={addCategory}>Add</button></div></div></div></div>)}